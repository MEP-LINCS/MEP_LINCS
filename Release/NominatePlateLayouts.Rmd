---
title: "MEP-LINCS Validation MEPs"
output:
html_document: default
html_notebook: default
---


```{r, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=4,
                      echo=FALSE, warning=FALSE, message=FALSE, root.dir="/data/share/dane/MEP-LINCS/MEP_LINCS/Release")
```

```{r}


library(readr, quietly = TRUE, warn.conflicts = FALSE,verbose=FALSE)
library(magrittr, quietly = TRUE, warn.conflicts = FALSE,verbose=FALSE)
library(dplyr, quietly = TRUE, warn.conflicts = FALSE,verbose=FALSE)
library(ggplot2, quietly = TRUE, warn.conflicts = FALSE,verbose=FALSE)
library(plotly, quietly = TRUE, warn.conflicts = FALSE,verbose=FALSE)
library(DT)


#Read in the 25 manually selected MEPs
MEPs <- read.csv("~/GrayLabData/dane/MEP-LINCS/MEP_LINCS/AnnotatedData/MCF10AMEPSforValidation.csv",stringsAsFactors = FALSE) %>% select(MEP,Ligand,ECMp)

#Set number of replicates at 4 for non-COL1 BMP MEPs and 3 for the rest.
MEPs$Replicates <- 3
MEPs$Replicates[grepl("BMP",MEPs$Ligand)&!grepl("COL1",MEPs$ECMp)]<-4

#Add in COL1_FBS and Col1_BMP2 MEPs
MEPs <-bind_rows(MEPs,data.frame(MEP=c("COL1_FBS","COL1_BMP2"),Ligand=c("FBS","BMP2"),ECMp=c("COL1","COL1"), Replicates=c(5,4)))

```


This report details the MEPs chosen for validation from the MCF10A dataset and presents three random layouts for 96 well plates. There are `r nrow(MEPs)` unique MEPs that are combinations of `r length(unique(MEPs$Ligand))` ligands and `r length(unique(MEPs$ECMp))` ECM proteins. 

Ligands  
`r unique(MEPs$Ligand)`  

ECM Proteins  
`r unique(MEPs$ECMp)`  



Clicking on the MEPs in the legends will show where they are in the layout.  



```{r plotPlateMap, fig.width=8}
#Randomize the plate positions in a reproducible maner
  set.seed(100)
  plate <- data.frame(MEP=rep(MEPs$MEP,times=MEPs$Replicates),Row=rep(1:8, each=12),Column=1:12, Well=paste0(rep(LETTERS[1:8],each=12),sprintf("%02d",rep(1:12))), stringsAsFactors = FALSE)
  plate$MEP <- plate$MEP[sample(1:nrow(plate), replace = FALSE)]
  plate <- plate[order(plate$Well),]

  plate$MEP <- as.factor(plate$MEP)
  p <- ggplot(plate, aes(x=Column, y=Row, colour=MEP))+
    geom_point(size=5)+
    xlim(0,13)+ylim(8,1)+
    guides(colour = guide_legend("MEP"))+ 
    ggtitle("Random Layout of Nominated MEPs (seed=100)")
 ggplotly(p)


```

```{r datatable42}
datatable(plate,options = list(pageLength = 5),)

```

<br>  
<br>  
  
  
```{r plotPlateMap2, fig.width=8}
#Randomize the plate positions in a reproducible maner
  set.seed(1234)
  plate <- data.frame(MEP=rep(MEPs$MEP,times=MEPs$Replicates),Row=rep(1:8, each=12),Column=1:12, Well=paste0(rep(LETTERS[1:8],each=12),sprintf("%02d",rep(1:12))), stringsAsFactors = FALSE)
  plate$MEP <- plate$MEP[sample(1:nrow(plate), replace = FALSE)]
  plate <- plate[order(plate$Well),]

  plate$MEP <- as.factor(plate$MEP)
  p <- ggplot(plate, aes(x=Column, y=Row, colour=MEP))+
    geom_point(size=5)+
    xlim(0,13)+ylim(8,1)+
    guides(colour = guide_legend("MEP"))+ 
    ggtitle("Random Layout of Nominated MEPs (seed=1234)")
 ggplotly(p)


```

```{r datatable1234}
datatable(plate,options = list(pageLength = 5),)

```

<br>  
<br>  
  
  
```{r plotPlateMap99, fig.width=8}
#Randomize the plate positions in a reproducible maner
  set.seed(99)
  plate <- data.frame(MEP=rep(MEPs$MEP,times=MEPs$Replicates),Row=rep(1:8, each=12),Column=1:12, Well=paste0(rep(LETTERS[1:8],each=12),sprintf("%02d",rep(1:12))), stringsAsFactors = FALSE)
  plate$MEP <- plate$MEP[sample(1:nrow(plate), replace = FALSE)]
  plate <- plate[order(plate$Well),]

  plate$MEP <- as.factor(plate$MEP)
  p <- ggplot(plate, aes(x=Column, y=Row, colour=MEP))+
    geom_point(size=5)+
    xlim(0,13)+ylim(8,1)+
    guides(colour = guide_legend("MEP"))+ 
    ggtitle("Random Layout of Nominated MEPs (seed=99)")
 ggplotly(p)


```

```{r datatable99}
datatable(plate,options = list(pageLength = 5),)

```

